"use strict";var _interopRequireWildcard=require("@babel/runtime/helpers/interopRequireWildcard"),_interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(exports,"__esModule",{value:!0}),exports["default"]=void 0;var _defineProperty2=_interopRequireDefault(require("@babel/runtime/helpers/defineProperty")),_typeof2=_interopRequireDefault(require("@babel/runtime/helpers/typeof")),_classCallCheck2=_interopRequireDefault(require("@babel/runtime/helpers/classCallCheck")),_createClass2=_interopRequireDefault(require("@babel/runtime/helpers/createClass")),_regenerator=_interopRequireDefault(require("@babel/runtime/regenerator")),_axios=_interopRequireDefault(require("axios")),_crypticoJs=_interopRequireWildcard(require("cryptico-js")),_https=_interopRequireDefault(require("https"));function ownKeys(a,b){var c=Object.keys(a);if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(a);b&&(d=d.filter(function(b){return Object.getOwnPropertyDescriptor(a,b).enumerable})),c.push.apply(c,d)}return c}function _objectSpread(a){for(var b,c=1;c<arguments.length;c++)b=null==arguments[c]?{}:arguments[c],c%2?ownKeys(b,!0).forEach(function(c){(0,_defineProperty2["default"])(a,c,b[c])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(b)):ownKeys(b).forEach(function(c){Object.defineProperty(a,c,Object.getOwnPropertyDescriptor(b,c))});return a}function AxiosGet(a,b,c,d){return _regenerator["default"].async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_regenerator["default"].awrap(_axios["default"].get(a,b).then(function(a){return _regenerator["default"].async(function(b){for(;;)switch(b.prev=b.next){case 0:if(!(c&&"function"==typeof c)){b.next=3;break}return b.next=3,_regenerator["default"].awrap(c(a.data));case 3:case"end":return b.stop();}})})["catch"](function(a){return _regenerator["default"].async(function(b){for(;;)switch(b.prev=b.next){case 0:if(!(d&&"function"==typeof d)){b.next=3;break}return b.next=3,_regenerator["default"].awrap(d(a));case 3:case"end":return b.stop();}})}));case 2:case"end":return e.stop();}})}function AxiosDelete(a,b,c,d){return _regenerator["default"].async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_regenerator["default"].awrap(_axios["default"]["delete"](a,b).then(function(a){return _regenerator["default"].async(function(b){for(;;)switch(b.prev=b.next){case 0:if(!(c&&"function"==typeof c)){b.next=3;break}return b.next=3,_regenerator["default"].awrap(c(a.data));case 3:case"end":return b.stop();}})})["catch"](function(a){return _regenerator["default"].async(function(b){for(;;)switch(b.prev=b.next){case 0:if(!(d&&"function"==typeof d)){b.next=3;break}return b.next=3,_regenerator["default"].awrap(d(a));case 3:case"end":return b.stop();}})}));case 2:case"end":return e.stop();}})}function AxiosPost(a,b,c,d,e){return _regenerator["default"].async(function(f){for(;;)switch(f.prev=f.next){case 0:return f.next=2,_regenerator["default"].awrap(_axios["default"].post(a,b,c).then(function(a){return _regenerator["default"].async(function(b){for(;;)switch(b.prev=b.next){case 0:if(!(d&&"function"==typeof d)){b.next=3;break}return b.next=3,_regenerator["default"].awrap(d(a.data));case 3:case"end":return b.stop();}})})["catch"](function(a){return _regenerator["default"].async(function(b){for(;;)switch(b.prev=b.next){case 0:if(!(e&&"function"==typeof e)){b.next=3;break}return b.next=3,_regenerator["default"].awrap(e(a));case 3:case"end":return b.stop();}})}));case 2:case"end":return f.stop();}})}function AxiosPut(a,b,c,d,e){return _regenerator["default"].async(function(f){for(;;)switch(f.prev=f.next){case 0:return f.next=2,_regenerator["default"].awrap(_axios["default"].put(a,b,c).then(function(a){return _regenerator["default"].async(function(b){for(;;)switch(b.prev=b.next){case 0:if(!(d&&"function"==typeof d)){b.next=3;break}return b.next=3,_regenerator["default"].awrap(d(a.data));case 3:case"end":return b.stop();}})})["catch"](function(a){return _regenerator["default"].async(function(b){for(;;)switch(b.prev=b.next){case 0:if(!(e&&"function"==typeof e)){b.next=3;break}return b.next=3,_regenerator["default"].awrap(e(a));case 3:case"end":return b.stop();}})}));case 2:case"end":return f.stop();}})}function RSAEncrypt(a,b){var c="",d=_crypticoJs["default"].b64to16(a.N),e=_crypticoJs["default"].b64to16(a.E),f=new _crypticoJs.RSAKey;f.setPublic(d,e);try{c+=_crypticoJs["default"].b16to64(f.encrypt(b))}catch(a){return""}return c}var ConnectionModule=/*#__PURE__*/function(){function a(b){var c=!!(1<arguments.length&&void 0!==arguments[1])&&arguments[1];(0,_classCallCheck2["default"])(this,a),this.rejectUnauthorized=!c,this.publicKey=b}return(0,_createClass2["default"])(a,null,[{key:"getInstance",value:function getInstance(b){var c,d,e,f=arguments;return _regenerator["default"].async(function(g){for(;;)switch(g.prev=g.next){case 0:return c=!!(1<f.length&&void 0!==f[1])&&f[1],d=null,e=new _https["default"].Agent({rejectUnauthorized:!c}),g.next=5,_regenerator["default"].awrap(AxiosGet(b,{httpsAgent:e},function(b){d=new a(b.data,c)}));case 5:return g.abrupt("return",d);case 6:case"end":return g.stop();}})}}]),(0,_createClass2["default"])(a,[{key:"agent",value:function agent(){return new _https["default"].Agent({rejectUnauthorized:this.rejectUnauthorized})}},{key:"getPublicKey",value:function getPublicKey(){return this.publicKey}},{key:"encrypt",value:function encrypt(a){return RSAEncrypt(this.publicKey,a)}},{key:"encryptPostData",value:function encryptPostData(a,b){if(b.encrypt&&"string"==typeof b.encrypt&&"all"===b.encrypt)return{data:RSAEncrypt(this.publicKey,JSON.stringify(a))};if(b.encrypt&&"object"===(0,_typeof2["default"])(b.encrypt)&&Array.isArray(b.encrypt)){for(var c=[],d=a,e=0;e<b.encrypt.length;e+=1)d[b.encrypt[e]]&&(d[b.encrypt[e]]=RSAEncrypt(this.publicKey,d[b.encrypt[e]]),c.push(b.encrypt[e]));return{data:d,Scope:c}}return a}},{key:"get",value:function get(a,b){var c,d;return _regenerator["default"].async(function(e){for(;;)switch(e.prev=e.next){case 0:return c=null,d=_objectSpread({},b),d.httpsAgent=this.agent(),e.next=5,_regenerator["default"].awrap(AxiosGet(a,d,function(a){return _regenerator["default"].async(function(b){for(;;)switch(b.prev=b.next){case 0:c=a;case 1:case"end":return b.stop();}})}));case 5:return e.abrupt("return",c);case 6:case"end":return e.stop();}},null,this)}},{key:"post",value:function post(a,b,c){var d,e,f;return _regenerator["default"].async(function(g){for(;;)switch(g.prev=g.next){case 0:return d=null,e=_objectSpread({},c),f=this.encryptPostData(b,e),e.encrypt&&delete e.encrypt,e.httpsAgent=this.agent(),g.next=7,_regenerator["default"].awrap(AxiosPost(a,f,e,function(a){d=a}));case 7:return g.abrupt("return",d);case 8:case"end":return g.stop();}},null,this)}},{key:"put",value:function put(a,b,c){var d,e,f;return _regenerator["default"].async(function(g){for(;;)switch(g.prev=g.next){case 0:return d=null,e=_objectSpread({},c),f=this.encryptPostData(b,e),e.encrypt&&delete e.encrypt,e.httpsAgent=this.agent(),g.next=7,_regenerator["default"].awrap(AxiosPut(a,f,e,function(a){d=a}));case 7:return g.abrupt("return",d);case 8:case"end":return g.stop();}},null,this)}},{key:"delete",value:function _delete(a,b){var c,d;return _regenerator["default"].async(function(e){for(;;)switch(e.prev=e.next){case 0:return c=null,d=_objectSpread({},b),d.httpsAgent=this.agent(),e.next=5,_regenerator["default"].awrap(AxiosDelete(a,d,function(a){c=a}));case 5:return e.abrupt("return",c);case 6:case"end":return e.stop();}},null,this)}}]),a}(),_default=ConnectionModule;exports["default"]=_default,module.exports=exports.default;